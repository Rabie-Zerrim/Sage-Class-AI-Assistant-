:root{
  --bg:#0b1220;
  --panel:#0f1724;
  --sidebar:#0b1017;
  --muted:#9aa4b2;
  --msg-in:#1f2933;
  --msg-out:#2563eb;
  --accent:#3b82f6;
  --card:#111827;
}

/* Base layout */
html,body{
  height:100%;
  margin:0;
  font-family: Inter, 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial;
  background:var(--bg);
  color:#e6eef6;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

.app-container{
  display:flex;
  height:100vh;
  width:100vw;
  overflow:hidden;
}

/* Left navigation / chats list */
.sidebar{
  width:300px;
  background:linear-gradient(180deg, rgba(12,16,22,0.9), rgba(7,11,16,0.95));
  border-right:1px solid rgba(255,255,255,0.04);
  padding:20px 18px;
  box-sizing:border-box;
  display:flex;
  flex-direction:column;
  gap:16px;
}

.sidebar .brand{
  display:flex;
  align-items:center;
  gap:12px;
}

.sidebar .brand .logo{
  width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:700;color:white;font-size:18px;box-shadow:0 6px 18px rgba(59,130,246,0.12);
}

.search{
  display:flex;align-items:center;background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;color:var(--muted);gap:8px;font-size:14px;border:1px solid rgba(255,255,255,0.02);
}

.chats{
  margin-top:6px;overflow:auto;padding-right:6px;display:flex;flex-direction:column;gap:8px;
}

.chat-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:12px;cursor:pointer;transition:all .2s ease;color:var(--muted)}
.chat-item:hover{background:rgba(255,255,255,0.05);color:#fff;transform:translateX(2px)}
.chat-item.active{background:linear-gradient(90deg, rgba(59,130,246,0.12), rgba(124,58,237,0.06));color:#fff}
.chat-item .avatar{width:46px;height:46px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#111827;color:#fff;font-weight:700;font-size:20px}
.chat-item .meta{flex:1;display:flex;flex-direction:column}
.chat-item .meta .name{font-weight:600;font-size:14px}
.chat-item .meta .last{font-size:12px;color:var(--muted);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* Main chat area */
.chat-area{flex:1;display:flex;flex-direction:column;min-width:0}

.topbar{height:72px;display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, transparent, rgba(255,255,255,0.01))}
.topbar .title{display:flex;align-items:center;gap:12px}
.topbar .title h2{margin:0;font-size:16px}
.topbar .title p{margin:0;color:var(--muted);font-size:13px}

.messages-wrap{flex:1;display:flex;padding:20px;gap:20px;overflow:hidden;position:relative}

.messages{
  flex:1;display:flex;flex-direction:column;gap:12px;overflow:auto;padding:10px 6px 140px 6px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
}

.message-row{display:flex;align-items:flex-end;gap:10px}
.message-row.incoming{justify-content:flex-start}
.message-row.outgoing{justify-content:flex-end}

.msg{
  max-width:68%;padding:12px 14px;border-radius:14px;font-size:14px;line-height:1.4;box-shadow:0 6px 16px rgba(2,6,23,0.5);position:relative;word-wrap:break-word;
}
.msg.incoming{background:var(--msg-in);color:#e6eef6;border-bottom-left-radius:4px}
.msg.outgoing{background:linear-gradient(90deg,var(--msg-out),#7c3aed);color:white;border-bottom-right-radius:4px}

.msg .meta{display:flex;gap:8px;align-items:center;margin-top:8px;font-size:12px;color:rgba(230,238,246,0.7)}

.avatar-small{width:36px;height:36px;border-radius:50%;flex:0 0 36px;display:flex;align-items:center;justify-content:center;background:#0b1220;color:#fff}

/* Input bar fixed at bottom */
.composer{
  position:absolute;
  right:360px;
  left:20px;
  bottom:20px;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding:12px;
  border-radius:14px;
  display:flex;
  gap:10px;
  align-items:center;
  border:1px solid rgba(255,255,255,0.03);
  z-index:10;
}
.composer textarea{
  flex:1;
  padding:12px;
  border-radius:10px;
  background:transparent;
  border:none;
  color:#e6eef6;
  resize:none;
  outline:none;
  font-size:14px;
  font-family:inherit;
  max-height:120px;
}
.composer textarea::placeholder{
  color:var(--muted);
}
.composer button{
  background:var(--accent);
  border:none;
  color:white;
  padding:10px 18px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  box-shadow:0 8px 20px rgba(59,130,246,0.12);
  transition:all 0.2s ease;
}
.composer button:hover{
  background:#1d4ed8;
  box-shadow:0 10px 24px rgba(59,130,246,0.18);
}

/* Right details panel */
.details{width:340px;background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent);border-left:1px solid rgba(255,255,255,0.03);padding:20px;box-sizing:border-box;display:flex;flex-direction:column;gap:14px}
.details h3{margin:0;color:var(--muted);font-size:13px}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);}

/* Scrollbars */
.chats::-webkit-scrollbar,.messages::-webkit-scrollbar{width:8px}
.chats::-webkit-scrollbar-thumb,.messages::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.03);border-radius:8px}

/* small helpers */
.muted{color:var(--muted)}
.rounded{border-radius:8px}

/* Animations */
@keyframes popIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
.msg{animation:popIn .18s ease}

/* Responsive tweaks */
@media (max-width:900px){
  .sidebar{display:none}
  .composer{left:16px;right:16px}
  .details{display:none}
}

/* Sage Avatar Animation */
.sage-avatar {
  width: 64px;
  height: 64px;
  position: relative;
}

.sage-image-container {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  overflow: hidden;
  background: linear-gradient(135deg, #10b981, #059669);
  box-shadow: 0 8px 20px rgba(16,185,129,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 3px solid rgba(16,185,129,0.2);
  transition: all 0.3s ease;
}

.sage-pixel-art {
  font-size: 42px;
  animation: idle 2s ease-in-out infinite;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.sage-pixel-art img {
  animation: idle 2s ease-in-out infinite;
}

@keyframes idle {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-2px) scale(1.02); }
}

@keyframes talking {
  0%, 100% { transform: scale(1) rotate(-2deg); }
  25% { transform: scale(1.08) rotate(2deg); }
  50% { transform: scale(1.05) rotate(-1deg); }
  75% { transform: scale(1.08) rotate(1deg); }
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 8px 20px rgba(16,185,129,0.3); }
  50% { box-shadow: 0 8px 30px rgba(16,185,129,0.6), 0 0 20px rgba(16,185,129,0.4); }
}

.sage-avatar.talking .sage-pixel-art {
  animation: talking 0.6s ease-in-out infinite;
}

.sage-avatar.talking .sage-image-container {
  animation: pulse-glow 1.5s ease-in-out infinite;
}

#sage-status {
  color: #10b981;
  font-weight: 600;
}

#sage-status.typing {
  color: #f59e0b;
}

#sage-status.typing::after {
  content: '...';
  animation: dots 1.5s steps(4, end) infinite;
}

@keyframes dots {
  0%, 20% { content: ''; }
  40% { content: '.'; }
  60% { content: '..'; }
  80%, 100% { content: '...'; }
}

/* Portal Animation for Sage Summoning */
@keyframes portal-spin {
  0% {
    transform: translate(-50%, -50%) rotate(0deg) scale(0);
    opacity: 0;
  }
  30% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) rotate(720deg) scale(1);
    opacity: 0.8;
  }
}

@keyframes portal-pulse {
  0%, 100% {
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.6),
                0 0 40px rgba(139, 92, 246, 0.4),
                inset 0 0 30px rgba(59, 130, 246, 0.3);
  }
  50% {
    box-shadow: 0 0 40px rgba(139, 92, 246, 0.9),
                0 0 80px rgba(139, 92, 246, 0.6),
                inset 0 0 50px rgba(59, 130, 246, 0.5);
  }
}

@keyframes sage-emerge {
  0% {
    transform: translate(-50%, -50%) scale(0) rotateY(0deg);
    opacity: 0;
    filter: blur(10px);
  }
  50% {
    transform: translate(-50%, -50%) scale(1.3) rotateY(180deg);
    filter: blur(2px);
  }
  100% {
    transform: translate(-50%, -50%) scale(1) rotateY(360deg);
    opacity: 1;
    filter: blur(0);
  }
}

@keyframes sparkle-burst {
  0% {
    transform: translate(-50%, -50%) scale(0);
    opacity: 1;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) translate(var(--tx), var(--ty)) scale(1);
    opacity: 0;
  }
}

@keyframes magic-circle {
  0% {
    transform: translate(-50%, -50%) rotate(0deg) scale(0.5);
    opacity: 0;
  }
  20% {
    opacity: 0.6;
  }
  100% {
    transform: translate(-50%, -50%) rotate(360deg) scale(1.8);
    opacity: 0;
  }
}

@keyframes star-twinkle {
  0% {
    transform: translate(-50%, -50%) scale(0) rotate(0deg);
    opacity: 0;
  }
  30% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) translate(var(--tx), var(--ty)) scale(1.5) rotate(180deg);
    opacity: 0;
  }
}

/* Portal Container */
.portal-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 300px;
  height: 300px;
  pointer-events: none;
  z-index: 9999;
}

.portal {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 200px;
  height: 200px;
  background: radial-gradient(circle, 
    rgba(139, 92, 246, 0.4) 0%,
    rgba(59, 130, 246, 0.3) 30%,
    rgba(16, 185, 129, 0.2) 60%,
    transparent 100%);
  border: 4px solid rgba(139, 92, 246, 0.7);
  border-radius: 50%;
  animation: portal-spin 2s ease-out, portal-pulse 2s ease-out infinite;
}

.portal::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 140%;
  height: 140%;
  border: 3px dashed rgba(59, 130, 246, 0.5);
  border-radius: 50%;
  animation: magic-circle 2s linear infinite;
}

.portal::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 70%;
  height: 70%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.3), transparent 70%);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  animation: pulse-glow 0.8s ease-out infinite;
}

.sage-summoned {
  position: absolute;
  top: 50%;
  left: 50%;
  font-size: 80px;
  animation: sage-emerge 1.2s ease-out 0.5s both;
  filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.9))
          drop-shadow(0 0 40px rgba(16, 185, 129, 0.6));
  z-index: 10;
}

.sparkle {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 6px;
  height: 6px;
  background: white;
  border-radius: 50%;
  box-shadow: 0 0 8px rgba(255, 255, 255, 0.9),
              0 0 16px rgba(139, 92, 246, 0.7);
  animation: sparkle-burst 1.8s ease-out forwards;
}

.star {
  position: absolute;
  top: 50%;
  left: 50%;
  font-size: 24px;
  animation: star-twinkle 2.2s ease-out forwards;
  text-shadow: 0 0 10px rgba(255, 215, 0, 0.9),
               0 0 20px rgba(255, 215, 0, 0.6);
}

/* Legacy class compatibility for existing JS */
.user-message{
  align-self: flex-end;
  background: linear-gradient(90deg,var(--msg-out),#7c3aed);
  color: white;
  padding: 12px 16px;
  border-radius: 20px 20px 4px 20px;
  max-width: 68%;
  word-wrap: break-word;
  margin-bottom: 8px;
  font-size: 14px;
  line-height: 1.5;
  box-shadow: 0 6px 16px rgba(2,6,23,0.5);
  animation: popIn .18s ease;
}

.bot-message{
  align-self: flex-start;
  background: var(--msg-in);
  color: #e6eef6;
  padding: 12px 16px;
  border-radius: 20px 20px 20px 4px;
  max-width: 68%;
  word-wrap: break-word;
  margin-bottom: 8px;
  font-size: 14px;
  line-height: 1.5;
  box-shadow: 0 6px 16px rgba(2,6,23,0.5);
  animation: popIn .18s ease;
}

.chat-output{
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* Video and Slide lists for compatibility */
.video-list, .slide-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 12px;
  margin-top: 12px;
}

.video-item, .slide-item {
  background: var(--card);
  border: 1px solid rgba(255,255,255,0.03);
  border-radius: 10px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.video-item:hover, .slide-item:hover {
  background: rgba(255,255,255,0.03);
  border-color: rgba(59,130,246,0.2);
  transform: translateY(-2px);
}

.video-thumbnail {
  width: 100%;
  border-radius: 6px;
  margin-bottom: 8px;
  background: rgba(255,255,255,0.02);
  aspect-ratio: 16/9;
}

.video-title, .slide-title {
  font-size: 13px;
  font-weight: 500;
  color: #e6eef6;
  text-align: left;
}

/* Button hover effects */
button:hover{
  opacity:0.9;
  transform:translateY(-1px);
}

button:active{
  transform:translateY(0);
}

/* Smooth scrolling */
html{
  scroll-behavior:smooth;
}

/* Text selection color */
::selection{
  background:rgba(59,130,246,0.3);
  color:white;
}

